import requests
import time
domain = input("Enter the target ip/website (introduce the protocol too): ")
start = time.time()
headers = requests.get(domain).headers
print(headers)
print()
if "X-Frame-Options" in headers:
    print("Domain not vulnerable to X-Frame-Options")
else:
    print(domain + " Is vulnerable (Missing X-Frame-Options)")
    print("Potential attacks exploiting this:")
    print("Clickjacking Attacks")
pass
print()
if "Strict-Transport-Security" in headers:
    print("Domain not vulnerable to HTTP Strict Transport Security (HSTS)")
else:
    print(domain + " Is vulnerable (Missing HTTP Strict Transport Security)")
    print("Potential attacks exploiting this:")
    print("Man-in-the-middle attacks")
    print("Protocol downgrades")
pass
print()
if "Access-Control-Allow-Methods" in headers:
    print("Domain not vulnerable to Access-Control-Allow-Methods")
else:
    print(domain + " Is vulnerable (Missing Access-Control-Allow-Methods)")
    print("Potential attacks exploiting this:")
    print("CORS Exploits (Cross-Origin Resource Sharing)")
    print("Unsafe HTTP methods like PUT, DELETE, PATCH, etc.")
pass
print()
if "X-XSS-Protection" in headers:
    print("Domain not vulnerable to X-XSS-Protection")
else:
    print(domain + " Is vulnerable (Missing X-XSS-Protection)")
    print("Potential attacks exploiting this:")
    print("Cross-Site Scripting (XSS) Attacks")
pass
print()
if "X-Content-Type-Options" in headers:
    print("Domain not vulnerable to X-Content-Type-Options")
else:
    print(domain + " Is vulnerable (Missing X-Content-Type-Options)")
    print("Potential attacks exploiting this:")
    print("MIME Sniffing Attacks")
    print("Potential XSS and drive-by download attacks")
pass
print()
if "X-Powered-By" in headers:
    print(domain + " Is vulnerable (Found X-Powered-By)")
    print("Potential attacks exploiting this:")
    print("Information Disclosure")
pass
print()
if "X-AspNet-Version" in headers:
    print(domain + " Is vulnerable (Found X-AspNet-Version)")
    print("Potential attacks exploiting this:")
    print("Information Disclosure")
pass
print()
if "Content-Security-Policy" not in headers:
    print(domain + " Is vulnerable (Missing Content-Security-Policy)")
    print("Potential attacks exploiting this:")
    print("Cross-Site Scripting (XSS)")
    print("Data Injection Attacks")
pass
print()
if "Referrer-Policy" not in headers:
    print(domain + " Is vulnerable (Missing Referrer-Policy)")
    print("Potential attacks exploiting this:")
    print("Information leakage through referrer headers")
end = time.time()
print()
print()
print(f"Time taken to run the code was {end-start} seconds")
input()